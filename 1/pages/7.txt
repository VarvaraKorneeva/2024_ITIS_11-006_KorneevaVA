Манипуляция со строками агрегация данных и группировка в Основы Уроки Примеры Библиотеки База знаний Поиск Основы Уроки Примеры Библиотеки База знаний Главная Библиотеки Трансформация данных в ч Трансформация данных в ч Манипуляция строками это популярный язык который благодаря своей простоте часто используется для обработки строк и текста Большая часть операций может быть выполнена даже с помощью встроенных функций А для более сложных используются регулярные выражения Встроенные методы для работы со строками В большинстве случаев имеются сложные строки которые желательно разделять на части и присваивать их правильным переменным Функция позволяет разбить тексты на части используя разделитель в качестве ориентира Им может быть например запятая По первому элементу видно что в конце у него остается пробел Чтобы решить эту проблему вместе со нужно также использовать функцию которая обрезает пустое пространство включая символы новой строки Результат массив строк Если элементов не много то можно выполнить присваивание вот так Помимо разбития текста на части часто требуется сделать обратное конкатенировать разные строки получив в результате текст большого объема Самый простой способ использовать оператор Но это сработает только в том случае если строк не больше двух трех Если же их больше то есть метод Его нужно применять к желаемому разделителю передав в качестве аргумента список строк Еще один тип операции которую можно выполнять со строкой поиск отдельных частей подстрок В для этого есть ключевое слово используемое для обнаружения подстрок Но имеются и две функции которые выполняют ту же задачу и В обоих случаях возвращаемое значение наименьший индекс где встречаются искомые символы Разница лишь в поведении функций в случае если подстрока не была найдена Если вернет сообщение с ошибкой то Также можно посчитать как часто символ или комбинация из нескольких подстрока встречаются в тексте За это отвечает функция Еще одна доступная операция замена или удаление подстроки или отдельного символа В обоих случаях применяется функция где удаление подстроки это то же самое что и замена ее на пустой символ Регулярные выражения Регулярные выражения предоставляют гибкий способ поиска совпадающих паттернов в тексте Выражение это строка написанная с помощью языка регулярных выражений В есть встроенный модуль который отвечает за работу с регулярными выражениями В первую очередь его нужно импортировать Модуль предоставляет набор функций которые можно поделить на три категории Поиск совпадающих паттернов Замена Разбиение Теперь разберем на примерах Регулярное выражение для поиска одного или последовательности пробельных символов В прошлом разделе вы видели как для разделения текста на части с помощью используется символ разделения В модуле есть такая же функция Она выполняет аналогичную задачу но в качестве аргумента условия разделения принимает паттерн с регулярным выражением что делает ее более гибкой Разберемся чуть подробнее с принципом работы модуля При вызове функции сперва компилируется регулярное выражение а только потом вызывается с готовым текстовым аргументом Можно скомпилировать функцию регулярного выражения с помощью и получить объект который будет использоваться повторно сэкономив таким образом циклы Это особенно важно для операций последовательного поиска подстроки во множестве или массиве строк Создав объект с помощью функции вы сможете прямо использовать следующим образом Для поиска совпадений паттерна с другими подстроками в тексте используется функция Она возвращает список всех подстрок которые соответствуют условиям Например если нужно найти в строке все слова начинающиеся с латинской в верхнем регистре или например с в любом регистре необходимо ввести следующее Есть еще две функции которые связаны с и И если возвращает все совпадения в списке то только первое Более того он является конкретным объектом Этот объект не содержит значение подстроки соответствующей паттерну а всего лишь индексы начала и окончания Функция ищет совпадение в начале строке если его нет для первого символа то двигается дальше и ищет в самой строке Если совпадений не найдено вовсе то она ничего не вернет В случае успеха же она возвращает то же что и функция Агрегация данных Последний этап работы с данными агрегация Он включает в себя преобразование в результате которого из массива получается целое число На самом деле ранее упоминаемые функции и это тоже агрегация Они работают с наборами данных и выполняют вычисления результатом которых всегда является одно значение Однако более формальный способ дающий больше контроля над агрегацией включает категоризацию наборов данных Категоризация набора необходимая для группировки это важный этап в процессе обработки данных Это тоже процесс преобразования ведь после разделения на группы применяется функция которая конвертирует или преобразовывает данные определенным образом в зависимости от того к какой группе они принадлежат Часто фазы группировки и применения функции происходит в один шаг Также для этого этапа анализа данных предоставляет гибкий и производительный инструмент Как и в случае с те кто знаком с реляционными базами данных и языком увидят знакомые вещи Однако языки такие как довольно ограничены когда их применяют к группам А вот гибкость таких языков как со всеми доступными библиотеками особенно дает возможность выполнять очень сложные операции Теперь разберем в подробностях механизм работы Он использует внутренний механизм процесс под названием Это паттерн который можно разбить на три фазы выделив отдельные операции Разделение разделение на группы датасетов Применение применение функции к каждой группе Комбинирование комбинирование результатов разных групп Рассмотрите процесс подробно на следующей схеме На первом этапе разделении данные из структуры или разделяются на несколько групп в соответствии с заданными критериями индексами или значениями в колонках На жаргоне значения в этой колонке называются ключами Если же вы работаете с двухмерными объектами такими как критерий группировки может быть применен и к строке и колонке Вторая фаза состоит из применения функции или если быть точнее вычисления основанного на функции результатом которого является одно значение характерное для этой группы Последний этап собирает результаты каждой группы и комбинирует их в один объект Практический пример Теперь вы знаете что процесс агрегации данных в разделен на несколько этапов разделение применение комбинирование И пусть в библиотеке они не выражены явно конкретными функциями функция генерирует объект который является ядром целого процесса Для лучшего понимания этого механизма стоит обратиться к реальному примеру Сперва создадим с разными числовыми и текстовыми значениями Предположим нужно посчитать среднюю стоимость в колонке с помощью меток из колонки Есть несколько способов как этого можно добиться Например можно получить доступ к колонке и затем вызвать где колонка будет выступать аргументом Результат объект Однако в этой операции не было никаких вычислений пока что была лишь собрана информация которая необходима для вычисления среднего значения Теперь у нас есть где все строки с одинаковым значением цвета сгруппированы в один объект Чтобы понять как произошло такое разделение на группы вызовите атрибут для объекта Как видите здесь перечислены все группы и явно обозначены строки в них Теперь нужно применить операцию для получения результатов каждой из групп Группировка по иерархии В прошлом разделе данные были сгруппированы по значениям колонки ключа Тот же подход можно использовать и для нескольких колонок сделав группировку нескольких ключей иерархической Группировка может работать не только с одной колонкой но и с несколькими или целым Также если объект не потребуется использовать несколько раз просто удобно выполнять группировки и расчеты за раз без объявления дополнительных переменных Итерация с группировкой Объект поддерживает операцию итерации для генерации последовательности из двух кортежей содержащих названия групп и их данных В последнем примере для иллюстрации был применен вывод переменных Но операцию вывода на экран можно заменить на функцию которую требуется применить Цепочка преобразований Из этих примеров должно стать понятно что при передаче функциям вычисления или другим операциям группировок вне зависимости от способа их получения результатом всегда является если была выбрана одна колонка или сохраняющий систему индексов и названия колонок Таким образом становится возможным выбрать одну колонку на разных этапах процесса Дальше три примера выбора одной колонки на трех разных этапах Они иллюстрируют гибкость такой системы группировки в Но также после операции агрегации имена некоторых колонок могут не нести нужное значение Поэтому часто оказывается полезным добавлять префикс объясняющий бизнес логику такого объединения Добавление префикса вместо использования полностью нового имени помогает отслеживать источник данных Это важно в случае применения процесса цепочки преобразований когда или генерируются друг из друга где важно отслеживать исходные данные Функции для групп Хотя многие методы не были реализованы специально для они корректно работают с В прошлых примерах было видно насколько просто получить на основе объекта указав имя колонки и применив метод для вычислений Например можно использование вычисление квантилей с помощью функции Также можно определять собственные функции агрегации Для этого функцию нужно создать и передать в качестве аргумента функции Например можно вычислить диапазон значений для каждой группы Функция позволяет использовать функции агрегации для всего объекта Также можно использовать больше функций агрегации одновременно с помощью передав массив со списком операций для выполнения Они станут новыми колонками Продвинутая агрегация данных В этом разделе речь пойдет о функциях и которые позволяют выполнять разные виды операций включая очень сложные Предположим что в одном нужно получить следующее оригинальный объект с данными и полученный с помощью вычисления агрегации например сложения Благодаря можно сложить результаты агрегации в каждой строке Но есть и другой способ работающий за счет Эта функция выполняет агрегацию но в то же время показывает значения сделанные с помощью вычислений на основе ключевого значения в каждой строке Метод более специализированная функция с конкретными условиями передаваемая в качестве аргумента функция должна возвращать одно скалярное значение агрегацию Метод для более привычных это Он в полной мере реализует схему разделение применение комбинирование Функция разделяет объект на части для преобразования вызывает функцию для каждой из частей и затем пытается связать их между собой Затем добавляется колонка с набором текстовых значений которые будут выступать ключевыми значениями Но в этом примере все равно есть повторяющиеся ключи ТЕГИ Максим Я создал этот блог в году чтобы распространять полезные учебные материалы документации и уроки на русском На сайте опубликовано множество статей по основам и библиотекам уроков для начинающих и примеров написания программ Мои контакты Почта Александр Редактор Статьи по теме Цветной вывод текста в Руководство по для начинающих Полное руководство по библиотеки для начинающих операции в Создание схемы в операции с помощью Введение в библиотеку установка и первые шаги Структуры данных в Возможности объектов в Основные функции все о Иерархическое индексирование и уровни признаков Чтение и запись данных Чтение и запись данных сериализация объектов Подготовка данных в Трансформация данных в ч Трансформация данных в ч Содержание Манипуляция строками Встроенные методы для работы со строками Регулярные выражения Агрегация данных Практический пример Группировка по иерархии Итерация с группировкой Цепочка преобразований Функции для групп Продвинутая агрегация данных Новое в блоге Нахождение делителей числа с помощью Лямбда функции и анонимные функции в Когда стоит использовать вместо в Как извлечь кубический корень в О проекте Политика конфиденциальности Правообладателям Контакты Хостинг Образовательный блог о 