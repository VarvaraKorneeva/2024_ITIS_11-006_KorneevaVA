Удаление повторов маппинг переименование колонок и выбросы в Основы Уроки Примеры Библиотеки База знаний Поиск Основы Уроки Примеры Библиотеки База знаний Главная Библиотеки Трансформация данных в ч Трансформация данных в ч Процесс подготовки данных для анализа включает сборку данных в с возможными добавлениями из других объектов и удалением ненужных частей Следующий этап трансформация После того как данные внутри структуры организованы нужно преобразовать ее значения Этот раздел будет посвящен распространенным проблемам и процессам которые требуются для их решения с помощью функций библиотеки Среди них удаление элементов с повторяющимися значениями изменение индексов обработка числовых значений данных и строк Удаление повторов Дубликаты строк могут присутствовать в по разным причинам И в объектах особо крупного размера их может быть сложно обнаружить Для этого в есть инструменты анализа повторяющихся данных для крупных структур Для начала создадим простой с повторяющимися строками Функция способна обнаружить дубликаты Она вернет объект состоящий из булевых значений где каждый элемент соответствует строке Их значения равны если строка является дубликатом все повторения за исключением первого и если повторов этого элемента не было Объект с булевыми элементами может быть особенно полезен например для фильтрации Так чтобы увидеть строки дубликаты нужно просто написать следующее Обычно повторяющиеся строки удаляются Для этого в есть функция которая возвращает без дубликатов Маппинг Библиотека предоставляет набор функций использующих маппинг для выполнения определенных операций Маппинг это всего лишь создание списка совпадений двух разных значений что позволяет привязывать значение определенной метке или строке Для определения маппинга лучше всего подходит объект Функции которые будут дальше встречаться в этом разделе выполняют конкретные операции но всегда принимают объект Заменяет значения Создает новый столбец Заменяет значения индекса Замена значений с помощью маппинга Часто бывает так что в готовой структуре данных присутствуют значения не соответствующие конкретным требованиям Например текст может быть написан на другом языке являться синонимом или например выраженным в другом виде В таких случаях используется операция замены разных значений Для примера определим с разными объектами и их цветами включая два названия цветов не на английском Для замены некорректных значений новыми нужно определить маппинг соответствий где ключами будут выступать новые значения Теперь осталось использовать функцию задав маппинг в качестве аргумента Как видно выше два цвета были заменены на корректные значения в Распространенный пример замена значений на другие например на Функция отлично справляется и с этим Добавление значений с помощью маппинга В предыдущем примере вы узнали как менять значения с помощью маппинга Теперь попробуем использовать маппинг на другом примере для добавления новых значений в колонку на основе значений в другой Маппинг всегда определяется отдельно Предположим что нужно добавить колонку с ценой вещи из объекта Также предположим что имеется список цен Определим его в виде объекта с ценами для каждого типа объекта Функция примененная к или колонке объекта принимает функцию или объект с маппингом В этому случае можно применить маппинг цен для элементов колонки добавив еще одну колонку в Переименование индексов осей По примеру того как работает изменение значений в и можно трансформировать метки оси с помощью маппинга Для замены меток индексов в есть функция которая принимает маппинг объект в качестве аргумента По умолчанию переименовываются индексы Если же нужно поменять названия колонок то используется параметр В следующем примере присвоим несколько маппингов двум индексам с параметром В тех случаях когда заменить нужно только одно значение все можно и не писать Пока что функция возвращала объект с изменениями не трогая оригинальный объект Но если нужно поменять его то необходимо передать значение параметру Дискретизация и биннинг Более сложный процесс преобразования называется дискретизацией Он используется для обработки большим объемов данных Для анализа их необходимо разделять на дискретные категории например распределив диапазон значений на меньшие интервалы и посчитав статистику для каждого Еще один пример большое количество образцов Даже здесь необходимо разделять весь диапазон по категориям и внутри них считать вхождения и статистику В следующем случае например нужно работать с экспериментальными значениями лежащими в диапазоне от до Эти данные собраны в список Вы знаете что все значения лежат в диапазоне от до а это значит что их можно разделить на одинаковых части бины В первом будут элементы от до во втором от до в третьем от до а в последнем от до Для этого в сначала нужно определить массив со значениями разделения Затем используется специальная функция которая применяется к массиву В нее нужно добавить и бины Функция возвращает специальный объект типа Его можно считать массивом строк с названиями бинов Внутри каждая содержит массив включающий названия разных внутренних категорий и массив со списком чисел равных элементам Число соответствует бину которому был присвоен соответствующий элемент Чтобы узнать число вхождений каждого бина то есть результаты для всех категорий нужно использовать функцию У каждого класса есть нижний предел с круглой скобкой и верхний с квадратной Такая запись соответствует математической используемой для записи интервалов Если скобка квадратная то число лежит в диапазоне а если круглая то нет Бинам можно задавать имена передав их в массив строк а затем присвоив его параметру в функции которая используется для создания объекта Если функции передать в качестве аргумента целое число а не границы бина то диапазон значений будет разделен на указанное количество интервалов Пределы будут основаны на минимуме и максимуме данных Также в есть еще одна функция для биннинга Она делит весь набор на квантили Так в зависимости от имеющихся данных обеспечит разное количество данных для каждого бина А позаботится о том чтобы количество вхождений было одинаковым Могут отличаться только границы В этом примере видно что интервалы отличаются от тех что получились в результате использования функции Также можно обратить внимание на то что попыталась стандартизировать вхождения для каждого бина поэтому в первых двух больше вхождений Это связано с тем что количество объектов не делится на Определение и фильтрация лишних данных При анализе данных часто приходится находить аномальные значения в структуре данных Для примера создайте с тремя колонками целиком случайных чисел С помощью функции можно увидеть статистику для каждой колонки Лишними можно считать значения которые более чем в три раза больше стандартного отклонения Чтобы оставить только подходящие нужно использовать функцию Теперь используйте фильтр для всех значений применив соответствующее стандартное отклонение для каждой колонки Функция позволит использовать фильтр для каждой колонки Перестановка Операции перестановки случайного изменения порядка в объекте или строках можно выполнить с помощью функции Для этого примера создайте с числами в порядке возрастания Теперь создайте массив из пяти чисел от до в случайном порядке с функцией Этот массив будет новым порядком в котором потребуется разместить и значения строк из Теперь примените его ко всем строкам с помощью функции Как видите порядок строк поменялся а индексы соответствуют порядку в массиве Перестановку можно произвести и для отдельной части Это сгенерирует массив с последовательностью ограниченной конкретным диапазоном например от до Случайная выборка Вы уже знаете как доставать отдельные части для последующей перестановки Но иногда ее потребуется отобрать случайным образом Проще всего сделать это с помощью функции В этом случае один и тот же участок попадается даже чаще ТЕГИ Максим Я создал этот блог в году чтобы распространять полезные учебные материалы документации и уроки на русском На сайте опубликовано множество статей по основам и библиотекам уроков для начинающих и примеров написания программ Мои контакты Почта Александр Редактор Статьи по теме Цветной вывод текста в Руководство по для начинающих Полное руководство по библиотеки для начинающих операции в Создание схемы в операции с помощью Введение в библиотеку установка и первые шаги Структуры данных в Возможности объектов в Основные функции все о Иерархическое индексирование и уровни признаков Чтение и запись данных Чтение и запись данных сериализация объектов Подготовка данных в Трансформация данных в ч Трансформация данных в ч Содержание Удаление повторов Маппинг Замена значений с помощью маппинга Добавление значений с помощью маппинга Переименование индексов осей Дискретизация и биннинг Определение и фильтрация лишних данных Перестановка Случайная выборка Новое в блоге Нахождение делителей числа с помощью Лямбда функции и анонимные функции в Когда стоит использовать вместо в Как извлечь кубический корень в О проекте Политика конфиденциальности Правообладателям Контакты Хостинг Образовательный блог о 